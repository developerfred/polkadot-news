{"version":3,"file":"memo.mjs","sources":["../../../src/util/memo.ts"],"sourcesContent":["export const keyedMemo =\n  <Arg extends [any], R>(\n    fn: (...arg: Arg) => R,\n    cache: Map<Arg[0], R> | WeakMap<Arg[0], R>,\n  ) =>\n  (...arg: Arg) => {\n    if (cache.has(arg[0])) return cache.get(arg[0])!\n    const result = fn(...arg)\n    cache.set(arg[0], result)\n    return result\n  }\n\nexport const memo = <Arg extends Array<unknown>, R>(fn: (...arg: Arg) => R) => {\n  let cachedKey: Arg | null = null\n  let cachedValue: R = null as any\n  return (...arg: Arg) => {\n    if (cachedKey && cachedKey.every((k, i) => k === arg[i])) {\n      return cachedValue\n    }\n    cachedKey = arg\n    cachedValue = fn(...arg)\n    return cachedValue\n  }\n}\n"],"names":[],"mappings":"AAAO,MAAM,SACX,GAAA,CACE,EACA,EAAA,KAAA,KAEF,IAAI,GAAa,KAAA;AACf,EAAI,IAAA,KAAA,CAAM,GAAI,CAAA,GAAA,CAAI,CAAC,CAAC,CAAG,EAAA,OAAO,KAAM,CAAA,GAAA,CAAI,GAAI,CAAA,CAAC,CAAC,CAAA;AAC9C,EAAM,MAAA,MAAA,GAAS,EAAG,CAAA,GAAG,GAAG,CAAA;AACxB,EAAA,KAAA,CAAM,GAAI,CAAA,GAAA,CAAI,CAAC,CAAA,EAAG,MAAM,CAAA;AACxB,EAAO,OAAA,MAAA;AACT;AAEW,MAAA,IAAA,GAAO,CAAgC,EAA2B,KAAA;AAC7E,EAAA,IAAI,SAAwB,GAAA,IAAA;AAC5B,EAAA,IAAI,WAAiB,GAAA,IAAA;AACrB,EAAA,OAAO,IAAI,GAAa,KAAA;AACtB,IAAI,IAAA,SAAA,IAAa,SAAU,CAAA,KAAA,CAAM,CAAC,CAAA,EAAG,MAAM,CAAM,KAAA,GAAA,CAAI,CAAC,CAAC,CAAG,EAAA;AACxD,MAAO,OAAA,WAAA;AAAA;AAET,IAAY,SAAA,GAAA,GAAA;AACZ,IAAc,WAAA,GAAA,EAAA,CAAG,GAAG,GAAG,CAAA;AACvB,IAAO,OAAA,WAAA;AAAA,GACT;AACF;;;;"}