var w=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ae=Object.prototype.hasOwnProperty;var ie=(e,r)=>{for(var n in r)w(e,n,{get:r[n],enumerable:!0})},pe=(e,r,n,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of oe(r))!ae.call(e,s)&&s!==n&&w(e,s,{get:()=>r[s],enumerable:!(t=se(r,s))||t.enumerable});return e};var ue=e=>pe(w({},"__esModule",{value:!0}),e);var le={};ie(le,{combineKeys:()=>B,contextBinder:()=>te,createKeyedSignal:()=>N,createListener:()=>ne,createSignal:()=>v,mergeWithKey:()=>D,partitionByKey:()=>z,selfDependant:()=>ee,selfDependent:()=>k,suspend:()=>T,suspended:()=>X,switchMapSuspended:()=>_,toKeySet:()=>$});module.exports=ue(le);var P=require("rxjs"),B=(e,r)=>new P.Observable(n=>{let t=new Map,s=new Set,o=new Map,p=!1,l=!0,i=()=>{if(!p){let b=Object.assign(o,{changes:s});s=new Set,l=!1,n.next(b)}},u=e.subscribe(b=>{p=!0;let K=new Set(V(b)?b.keys:b);V(b)?b.type==="remove"&&(K.forEach(c=>{let a=t.get(c);!a||(a.unsubscribe(),t.delete(c),o.has(c)&&(s.add(c),o.delete(c)))}),K.clear()):t.forEach((c,a)=>{K.has(a)?K.delete(a):(c.unsubscribe(),t.delete(a),o.has(a)&&(s.add(a),o.delete(a)))}),K.forEach(c=>{t.set(c,r(c).subscribe(a=>{(!o.has(c)||o.get(c)!==a)&&(s.add(c),o.set(c,a),i())},a=>{n.error(a)}))}),p=!1,(s.size||l&&!K.size)&&i()},b=>{n.error(b)},()=>{n.complete()});return()=>{u.unsubscribe(),t.forEach(b=>{b.unsubscribe()})}});function V(e){return"type"in e&&"keys"in e}var O=require("rxjs");function v(e=O.identity){let r=new O.Subject;return[r.asObservable(),(...n)=>r.next(e(...n))]}var L=require("rxjs");function N(e,r){let n=new Map;return[t=>{let s=new L.Observable(o=>{n.has(t)||n.set(t,new Set);let p=n.get(t);return p.add(o),()=>{p.delete(o),p.size===0&&n.delete(t)}});return s.key=t,s},(...t)=>{var p;let s=r?r(...t):t.length===2?t[1]:t[0],o=e?e(s):t[0];(p=n.get(o))==null||p.forEach(l=>{l.next(s)})}]}var S=require("rxjs"),U=require("rxjs/operators"),D=(e,...r)=>(0,S.merge)(...Object.entries(e).map(([n,t])=>(0,S.from)(t).pipe((0,U.map)(s=>({type:n,payload:s})))).concat(r));var A=require("@react-rxjs/core"),f=require("rxjs"),G=require("rxjs/operators");function z(e,r,n){let t=new f.Observable(i=>{let u=new Map,b=!1,K=a=>(...d)=>{b=!0,u.size?u.forEach(y=>y.source[a](...d)):i[a](...d)},c=e.subscribe(a=>{let d=r(a);if(u.has(d))return u.get(d).source.next(a);let y=!0,E=()=>{y&&(y=!1,i.next({groups:u,changes:{type:"add",keys:[d]}}))},g=new f.Subject,R=!0,C=()=>{R&&(R=!1,g.next(a))},M=(0,A.shareLatest)()((n||f.identity)(g,d)),I=new f.Observable(h=>{p();let j=M.subscribe(h);return j.add(l),C(),j});I.key=d;let F={source:g,observable:I,subscription:new f.Subscription};u.set(d,F),F.subscription=M.subscribe(f.noop,h=>i.error(h),()=>{u.delete(d),E(),i.next({groups:u,changes:{type:"remove",keys:[d]}}),u.size===0&&b&&i.complete()}),E(),C()},K("error"),K("complete"));return()=>{c.unsubscribe(),u.forEach(a=>{a.source.unsubscribe(),a.subscription.unsubscribe()})}}).pipe((0,A.shareLatest)()),s=0,o;function p(){s++,s===1&&(o=t.subscribe())}function l(){s--,s===0&&(o==null||o.unsubscribe())}return[i=>ce(t.pipe((0,G.map)(({groups:u})=>u)),i),t.pipe((0,G.map)((i,u)=>u===0?{type:"add",keys:i.groups.keys()}:i.changes))]}var ce=(e,r)=>{let n=new f.Observable(t=>{let s,o,p=!1;return o=e.subscribe(l=>{let i=l.get(r);i&&!s&&(s=i.observable.subscribe(t),o==null||o.unsubscribe(),p=!0)},l=>{t.error(l)},()=>{t.complete()}),p&&(o.unsubscribe(),o=void 0),()=>{s==null||s.unsubscribe(),o==null||o.unsubscribe()}});return n.key=r,n};var W=require("rxjs");function $(){return e=>new W.Observable(r=>{let n=new Set,t=!0,s=e.subscribe({next({type:o,keys:p}){let l=o==="add"?o:"delete";for(let i of p)n[l](i);r.next(n),t=!1},error(o){r.error(o)},complete(){r.complete()}});return t&&r.next(n),s})}var J=require("rxjs"),Q=require("@react-rxjs/core");var q=require("rxjs"),H=e=>r=>new q.Observable(n=>{let t=!1,s=r.subscribe(o=>{t=!0,n.next(o)},o=>{n.error(o)},()=>{n.complete()});return t||n.next(e),s});var T=e=>H(Q.SUSPENSE)((0,J.from)(e));var X=()=>T;var Y=require("rxjs"),Z=require("rxjs/operators");var _=e=>(0,Y.pipe)((0,Z.switchMap)((r,n)=>T(e(r,n))));var m=require("rxjs"),x=require("rxjs/operators"),k=()=>{let e=new m.BehaviorSubject(new m.Subject);return[e.pipe((0,x.switchAll)()),()=>(0,x.tap)({next:r=>e.value.next(r),error:r=>{e.value.error(r),e.next(new m.Subject)},complete:()=>{e.value.complete(),e.next(new m.Subject)}})]},ee=k;var re=require("@react-rxjs/core"),be=e=>e();function te(...e){let r=()=>e.map(be);return function(){let[n,t]=re.bind.apply(null,arguments);return[(...s)=>n(...r(),...s),t]}}function ne(...e){return v(...e)}
//# sourceMappingURL=utils.cjs.production.min.js.map
